---
title: "Code for Visualization of Colleges and Players"
output: html_document
---
``` {r}
library(maps)
library(ggplot2)

# Graphing a bar chart of the top ten colleges with the most players
player_colleges <- read.csv("data/player_colleges")
college_table <- as.data.frame(table(player_colleges$College), stringsAsFactors = F)
colnames(college_table) <- c("College", "Total_Players")
player_colleges <- left_join(player_colleges, college_table, by = "College")
top_ten <- subset(player_colleges, Total_Players >= 10 & Total_Players < 100)
ggplot(top_ten, aes(College, fill = Exp)) + 
         geom_bar() +
         coord_flip() +
         labs(y = "Number of players") +
  ggtitle("Top Ten Colleges/Universities with the Most NBA Players")

# Graphing a map of colleges that have players
par(mar = c(1, 1, 1, 1))
map("state", boundary = TRUE, interior = TRUE, lty = 1, add = FALSE)
points(player_colleges$Longitude, player_colleges$Latitude, 
       pch = 20, cex = 0.4, col = "#0000ff")
title("Colleges / Universities that NBA Players Attended")
```