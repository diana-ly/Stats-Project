---
title: "Final Project 2"
author: "Stacy J Chang"
date: "December 6, 2015"
output: word_document
---
# Final Project 
## NBA Performance Correlation Analysis 
## "Does performance and salary correlate? Do high performing players earn the most money?"

### IMPORTING & CLEANING DATA

```{r}
setwd('/Users/Stacy/Berkeley/Cal2/Stat133/Project/Final Project/')
```

Data Cleaning

The leading NBA teams in all 6 divisions: Atlantic Division, Central Division, Southeat Division, Northwest Division, Pacific Division, Southwest Division. The teams are Toranto Raptors, Cleveland Cavaliers, Atlanta Hawks, Portland Trail Blazers, Golden State Warriors, and Houston Rockets respectively. We retrieved the csv files of the rosters and each players' stats for the 2014-2015 season from basketball=reference.com and espn. This part of the project is to combine the different team files into one data file. 

First, the rosters:
```{r}
# Import all the team files
roster <- read.csv('roster', stringsAsFactors = FALSE)
```

Second: Players' 2014-2015 season stats:
```{r}
player_stats <- read.csv('player stats', stringsAsFactors = FALSE)
```

### COMPILING DATA

#### Setting Directory
```{r}
salary <- read.csv('salary1415.csv', stringsAsFactors = FALSE)
```

#### Data frame of Basketball Data and Salary 
```{r}
library('dplyr')
stats_salary <- left_join(player_stats, salary, by = 'Player')
stats_salary <- subset(stats_salary, select = -c(Team.y, X.y, X.x, Position))

for (i in 1:length(row.names(stats_salary))) {
  if (is.na(stats_salary[i, ]$Salary14.15)) {
    stats_salary <- stats_salary[-c(i), ]
  }
}
write.csv(stats_salary, file = 'stats and salary')
```

#### Data frame of Basketball Data, Position, and Salary (FINAL)  
```{r}
position <- subset(roster, select = c(Player, Pos))
final_roster <- unique(left_join(stats_salary, position, by = 'Player'))

for (i in 1:length(row.names(final_roster))) {
  if (is.na(final_roster[i, ]$Salary14.15)) {
    final_roster <- final_roster[-c(i), ]
  }
}

final_roster1 <- gsub('\\$', '', final_roster$Salary14.15)
final_roster1 <- as.numeric(gsub(",","", final_roster1))
final_roster$Salary14.15 <- final_roster1

```

### DATA VISUALIZATION

#### Correlation Calculation
```{r}
corr_eqn <- function(x,y, digits = 2) {
  corr_coef <- round(cor(x,y), digits = digits)
  paste("italic(r) == ", corr_coef)
}
```

#### 1. POINT GUARD Correlation plot
```{r}
library('ggplot2')
point_guard <- final_roster[final_roster$Pos == 'PG', ]
ggplot(point_guard, aes(x = point_guard$Salary14.15, y = point_guard$AST)) +
  geom_point() +
  geom_smooth(method = 'lm') +
  labs(x = 'Salary', y = 'Assist') +
  ggtitle('Point Guard Salary and Assist Correlation') +
  geom_text(aes(x = 1.5e+07, y = 400, label = corr_eqn(point_guard$AST, point_guard$Salary14.15)), parse = TRUE)

```

#### 2. CENTER Correlation plot
```{r}
center <- final_roster[final_roster$Pos == 'C',]
ggplot(center, aes(x = center$Salary14.15, y = center$ORB)) +
  geom_point() +
  geom_smooth(method = 'lm') +
  labs(x = 'Salary', y = 'Offensive Rebounds') +
  ggtitle('Center Salary and Rebounds Correlation') +
  geom_text(aes(x = 2.0e+07, y = 200, label = corr_eqn(center$ORB, center$Salary14.15)), parse = TRUE)

# PROBLEM: r = NA
```

#### 3. SMALL FORWARD Correlation plot
```{r}
small_forward <- final_roster[final_roster$Pos == 'SF', ]
ggplot(small_forward, aes(x = small_forward$Salary14.15, y = small_forward$X3P.)) +
  geom_point() +
  geom_smooth(method = 'lm') +
  labs(x = 'Salary', y = '3 Points Percentage') +
  ggtitle('Small Forward Salary and 3 Points Percentage Correlation') +
  geom_text(aes(x = 1.5e+07, y = 0.3, label = corr_eqn(small_forward$X3P, small_forward$Salary14.15)), parse = TRUE)
```

#### 4. POWER FORWARD Correlation plot
```{r}
power_forward <- final_roster[final_roster$Pos == 'PF', ]
ggplot(power_forward, aes(x = power_forward$Salary14.15, y = power_forward$TRB)) +
  geom_point() +
  geom_smooth(method = 'lm') +
  labs(x = 'Salary', y = 'Total Rebounds') +
  ggtitle('Power Forward Salary and Total Rebounds Correlation') +
  geom_text(aes(x = 1.5e+07, y = 500, label = corr_eqn(power_forward$TRB, power_forward$Salary14.15)), parse = TRUE)
```

#### 5. SHOOTING GUARD Correlation plot
```{r}
shooting_guard <- final_roster[final_roster$Pos == 'SG', ]
ggplot(shooting_guard, aes(x = shooting_guard$Salary14.15, y = shooting_guard$eFG.)) +
  geom_point() +
  geom_smooth(method = 'lm') +
  labs(x = 'Salary', y = 'Field Goal Percentage') +
  ggtitle('Shooting Guard Salary and Field Goal Percentage Correlation') +
  geom_text(aes(x = 2.0e+07, y = 0.4, label = corr_eqn(shooting_guard$eFG., shooting_guard$Salary14.15)), parse = TRUE)
```

